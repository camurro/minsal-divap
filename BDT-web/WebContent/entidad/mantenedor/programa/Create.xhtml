<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">





<ui:composition>

	<p:dialog id="ProgramaCreateDlg" widgetVar="ProgramaCreateDialog"
		modal="true" resizable="false" appendToBody="true"
		header="#{messages.CreateProgramaTitle}" closeOnEscape="true">

		<h:form id="ProgramaCreateForm">
			<p:wizard flowListener="#{programaController.onFlowProcess}">
				<p:tab id="datosPrograma" title="Datos Programa">
					<p:panel header="Detalle">

						<h:panelGroup id="display"
							rendered="#{programaController.seleccionado != null}">
							<p:panelGrid columns="2" columnClasses="column">


								<p:outputLabel value="#{messages.CreateProgramaLabel_nombre}"
									for="nombre" />
								<p:inputText id="nombre"
									value="#{programaController.seleccionado.nombrePrograma}"
									title="#{messages.CreateProgramaTitle_nombre}" />

								<p:outputLabel value="#{messages.CreateProgramaLabel_usuario}"
									for="usuario" />
								<p:selectOneMenu id="usuario"
									value="#{programaController.seleccionado.nombreUsuario}">
									<f:selectItem itemLabel="#{messages.SelectOneMessage}" />
									<f:selectItems value="#{programaController.usuarios}"
										var="usuarioItem" itemValue="#{usuarioItem.username}"
										itemLabel="#{usuarioItem.username}" />
								</p:selectOneMenu>

								<p:outputLabel
									value="#{messages.CreateProgramaLabel_descripcion}"
									for="descripcion" />
								<p:inputText id="descripcion"
									value="#{programaController.seleccionado.descripcion}"
									title="#{messages.CreateProgramaTitle_descripcion}" />

								<p:outputLabel
									value="#{messages.CreateProgramaLabel_revisaFonasa}"
									for="revisaFonasa" />
								<p:selectBooleanCheckbox id="revisaFonasa"
									value="#{programaController.seleccionado.fonasa}" />

								<p:outputLabel
									value="#{messages.CreateProgramaLabel_reliquidacion}"
									for="reliquidacion" />
								<p:selectBooleanCheckbox id="reliquidacion"
									value="#{programaController.seleccionado.reliquidacion}" />


							</p:panelGrid>
						</h:panelGroup>
					</p:panel>
				</p:tab>
				<p:tab id="cuotas" title="Cuotas">
					<p:panel header="Detalle">
						<p:messages />

						<p:dataTable id="tabla" resizableColumns="true" value="#{programaController.cuotas}" liveResize="true"
							var="_data" rows="10" paginator="true" paginatorPosition="bottom" editable="true"
							emptyMessage="No se encontro informaciÃ³n." styleClass="dataTable" scrollable="true">
							
							<f:facet name="header">
					           Cuotas
					       </f:facet>
					       
					       <p:ajax event="rowEdit" listener="#{programaController.onRowEdit}" update=":ProgramaEditForm:tabla" />
      					   <p:ajax event="rowEditCancel" listener="#{programaController.onRowCancel}" update=":ProgramaEditForm:tabla" />
      					   
      					   <p:column headerText="Nro Cuota">
					           <p:cellEditor>
					               <f:facet name="output"><h:outputText value="#{_data.nroCuota}" /></f:facet>
					               <f:facet name="input"><p:inputText id="modelInput" value="#{_data.nroCuota}" style="width:100%"/></f:facet>
					           </p:cellEditor>
					       </p:column>
					       
					       <p:column headerText="Porcentaje">
					           <p:cellEditor>
					               <f:facet name="output"><h:outputText value="#{_data.porcentaje_cuota}" /></f:facet>
					               <f:facet name="input"><p:inputText value="#{_data.porcentaje_cuota}" style="width:100%"/></f:facet>
					           </p:cellEditor>
					       </p:column>
					       
					       <p:column headerText="Fecha Pago">
					           <p:cellEditor>
					               <f:facet name="output"><h:outputText value="#{_data.fecha_cuota}" /></f:facet>
					               <f:facet name="input"><p:calendar pattern="dd/MM/yyyy" value="#{_data.fecha_cuota}" showOn="button" /></f:facet>
					               
					           </p:cellEditor>
					       </p:column>
					       
					       <p:column headerText="Monto">
					           <p:cellEditor>
					               <f:facet name="output"><h:outputText value="#{_data.monto_cuota}" /></f:facet>
					               <f:facet name="input"><p:inputText value="#{_data.monto_cuota}" style="width:100%"/></f:facet>
					           </p:cellEditor>
					       </p:column>
					       
					       <p:column style="width:32px">
					           <p:rowEditor />
					       </p:column>

						</p:dataTable>
						
						<p:panel id="gridCuotas">

							<h3>Ingrese Cuota</h3>
							<table>
								<tr>
									<td>Porcentaje :</td>
									<td><h:inputText id="porcentajeCuota" size="20"
											value="#{programaController.porcentaje_cuota}" /></td>
								</tr>
								<tr>
									<td>Fecha de Pago :</td>
									<td><p:calendar id="fechaPago" pattern="dd/MM/yyyy"
											value="#{programaController.fecha_cuota}"
											title="#{messages.CreateCuotaTitle_fechaPago}" showOn="button" rendered="#{not programaController.firstCuota}"  /></td>
	
								</tr>
								<tr>
									<td>Monto :</td>
									<td><h:inputText id="monto" size="5" value="#{programaController.monto_cuota}" /></td>
								</tr>
							</table>
							
						</p:panel>

						<p:commandButton value="Agregar" onclick="agregarFila();" update="ProgramaCreateForm:tabla ProgramaCreateForm:gridCuotas" />

					</p:panel>

					<p:commandButton actionListener="#{programaController.saveNew}" value="#{messages.Save}" update="display,:ProgramaListForm:datalist,:growl"
						oncomplete="handleSubmit(xhr,status,args,ProgramaCreateDialog);" />
						
					<p:commandButton value="#{messages.Cancel}" onclick="ProgramaCreateDialog.hide()" />
				</p:tab>

			</p:wizard>
		</h:form>
		
		<h:form id="formAgregarCuota">
			<h:inputHidden value="#{programaController.nroCuota}"
				id="hiddenNroCuota" />
			<h:inputHidden value="#{programaController.porcentaje_cuota}"
				id="hiddenPorcentaje" />
			<h:inputHidden value="#{programaController.fecha_convertida}"
				id="hiddenFecha" />
			<h:inputHidden value="#{programaController.monto_cuota}"
				id="hiddenMonto" />


			<p:commandButton id="botonAgregaCuota" style="visibility: hidden;"
				actionListener="#{programaController.addAction}">
			</p:commandButton>

		</h:form>


	</p:dialog>

</ui:composition>

</html>
