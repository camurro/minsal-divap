<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html" xmlns:p="http://primefaces.org/ui" template="/WEB-INF/templates/default.xhtml">

	<ui:define name="content">
		<h:form enctype="multipart/form-data">
			<p:panel styleClass="contentPanel">
				<h1>
					<h:outputText value="Rebaja" />
				</h1>
				<p:panel id="Panel">
					<h2>
						<strong>Actividad:</strong> Revisión y Validación de los Montos de Rebaja
					</h2>
					<p class="parrafo">La planilla de Montos de Distribución contiene lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent
						egestas tempor nulla eget ultricies. Morbi pulvinar elit Maecenas sollicitudin odio imperdiet orci sollicitudin convallis. Etiam
						hendrerit, tellus a lacinia dignissim, justo nisi porttitor enim, eget ullamcorper felis augue eget lacus.</p>
					<br />

					<div class="destacaArchivos ui-corner-all">
						<h3>Archivos disponibles para la Tarea:</h3>
						<span class="strong">Archivo: </span> Planilla Montos de Rebaja [
						<h:graphicImage value="resources/minsal/images/download-alt.png" styleClass="divapIcons" />
						<p:commandLink value="Bajar Última Versión" />
						]
						<ul class="versionesArchivo">
							<li><h:graphicImage value="resources/minsal/images/download-alt.png" styleClass="divapIcons" /> <p:commandLink
									value="Planilla de Montos de Rebaja-v2.xls" /> (Modificado el 10 de Abril de 2014 a las 14:31 por Juan Arriagada)</li>
							<li><h:graphicImage value="resources/minsal/images/download-alt.png" styleClass="divapIcons" /> <p:commandLink
									value="Planilla de Montos de Rebaja-v1.xls" /> (Modificado el 6 de Abril de 2014 a las 14:31 por Robson Watt)</li>
						</ul>
					</div>
					<h3>Visualizador: Montos de Rebaja</h3>
					<!-- INICIO: MODAL CON INFORMACIóN Y FILTROS VISTA ONLINE -->

					<p:panel styleClass="appMenu">
						<h4>Filtros de Búsqueda:</h4>
						<h:panelGrid columns="4" id="busqueda_mis_tareas">
							<h:panelGrid columns="2">
								<h:outputText value="Región: " styleClass="inputLabel" />
								<p:selectOneMenu>
									<f:selectItem itemLabel="METROPOLITANA" itemValue="METROPOLITANA" />
									<f:selectItem itemLabel="Ver Todo" itemValue="Ver Todo" />
									<f:selectItem itemLabel="Seleccione" itemValue="" />
								</p:selectOneMenu>
							</h:panelGrid>

							<h:panelGrid columns="2">
								<h:outputText value="Servicio: " styleClass="inputLabel" />
								<p:selectOneMenu>
									<f:selectItem itemLabel="SANTIAGO" itemValue="SANTIAGO" />
									<f:selectItem itemLabel="Seleccione" itemValue="" />
								</p:selectOneMenu>
							</h:panelGrid>

							<h:panelGrid columns="2">
								<h:outputText value="Comuna: " styleClass="inputLabel" />
								<p:selectCheckboxMenu value="#{procesoRebajaController.comunasSeleccionadas}" label="Seleccione" filter="true" filterText="Filter"
									filterMatchMode="startsWith">
									<f:selectItems value="#{procesoRebajaController.comunas}" />
								</p:selectCheckboxMenu>
							</h:panelGrid>

							<h:panelGrid columns="2">
								<p:commandButton value="Buscar" styleClass=" x-btn-text icon-guardar" update="tablaMisTareas" icon="ui-icon-search" />
								<p:commandButton value="Limpiar" styleClass=" x-btn-text icon-guardar" update="tablaMisTareas" icon="ui-icon-trash" />
							</h:panelGrid>

						</h:panelGrid>
					</p:panel>
					<br />
					<p:dataTable id="tablaMisTareas" resizableColumns="true" value="#{procesoRebajaController.listRebaja}" liveResize="true" var="_rebaja"
						rows="10" paginator="false" paginatorPosition="bottom" emptyMessage="No se encontro información." styleClass="dataTable">
						<p:columnGroup type="header">
							<!--  -->
							<p:row>
								<p:column rowspan="2" headerText="Comuna" />
								<p:column rowspan="2" headerText="Aporte Estatal {MAYO}" />
								<p:column colspan="3" headerText="Cumplimiento" />
								<p:column colspan="4" headerText="Rebaja Calculada" />
								<p:column colspan="4" headerText="Rebaja Final" />
								<p:column rowspan="2" headerText="Monto Rebaja {MAYO}" />
								<p:column rowspan="2" headerText="Nuevo Aporte Estatal {MAYO}" />
								<p:column rowspan="2" headerText="Guardar" />
							</p:row>
							<p:row>
								<p:column headerText="item1" />
								<p:column headerText="item2" />
								<p:column headerText="item3" />

								<p:column headerText="reb1" />
								<p:column headerText="reb2" />
								<p:column headerText="reb3" />
								<p:column headerText="total" />

								<p:column headerText="reb ex1" />
								<p:column headerText="reb ex2" />
								<p:column headerText="reb ex3" />
								<p:column headerText="total" />
								
								
							</p:row>
						</p:columnGroup>
						<p:column><h:outputText value="#{_rebaja.comuna}"  styleClass="textoPequenio textoAjustado" /></p:column>
						<p:column>
							<h:outputText value="#{_rebaja.marco}" styleClass="textoPequenio textoAjustado">
								<f:convertNumber type="currency" maxFractionDigits="0" locale="es_CL" currencySymbol="$" />
							</h:outputText>
						</p:column>
						<p:column>
							<h:outputText value="#{_rebaja.itemCumplimiento1}" styleClass="textoPequenio textoAjustado">
								<f:convertNumber type="percent" />
							</h:outputText>
						</p:column>
						<p:column>
							<h:outputText value="#{_rebaja.itemCumplimiento2}" styleClass="textoPequenio textoAjustado">
								<f:convertNumber type="percent" />
							</h:outputText>
						</p:column>
						<p:column>
							<h:outputText value="#{_rebaja.itemCumplimiento3}" styleClass="textoPequenio textoAjustado">
								<f:convertNumber type="percent" />
							</h:outputText>
						</p:column>
						<p:column>
							<h:outputText value="#{_rebaja.rebaja1}" styleClass="textoPequenio textoAjustado">
								<f:convertNumber type="percent" />
							</h:outputText>
						</p:column>
						<p:column>
							<h:outputText value="#{_rebaja.rebaja2}" styleClass="textoPequenio textoAjustado">
								<f:convertNumber type="percent" />
							</h:outputText>
						</p:column>
						<p:column>
							<h:outputText value="#{_rebaja.rebaja3}" styleClass="textoPequenio textoAjustado">
								<f:convertNumber type="percent" />
							</h:outputText>
						</p:column>
						<p:column>
							<h:outputText value="#{_rebaja.totalRebaja}" styleClass="textoPequenio textoAjustado">
								<f:convertNumber type="percent" />
							</h:outputText>
						</p:column>

						<p:column>
							<h:inputText value="#{_rebaja.rebajaExcepcional1}" styleClass="textoPequenioInput textoAjustado">
								<f:convertNumber type="percent" />
							</h:inputText>
						</p:column>
						<p:column>
							<h:inputText value="#{_rebaja.rebajaExcepcional2}" styleClass="textoPequenioInput textoAjustado">
								<f:convertNumber type="percent" />
							</h:inputText>
						</p:column>
						<p:column>
							<h:inputText value="#{_rebaja.rebajaExcepcional3}" styleClass="textoPequenioInput textoAjustado">
								<f:convertNumber type="percent" />
							</h:inputText>
						</p:column>

						<p:column>
							<h:outputText value="#{_rebaja.totalRebajaExcepcional}" styleClass="textoPequenio textoAjustado">
								<f:convertNumber type="percent" />
							</h:outputText>
						</p:column>

						<p:column>
							<h:outputText value="#{_rebaja.marco*_rebaja.totalRebaja}" styleClass="textoPequenio textoAjustado">
								<f:convertNumber type="currency" maxFractionDigits="0" locale="es_CL" currencySymbol="$" />
							</h:outputText>
						</p:column>
						<p:column>
							<h:outputText value="#{_rebaja.marco-(_rebaja.marco*_rebaja.totalRebaja)}" styleClass="textoPequenio textoAjustado">
								<f:convertNumber type="currency" maxFractionDigits="0" locale="es_CL" currencySymbol="$" />
							</h:outputText>
						</p:column>
						<p:column>
							<p:commandButton icon="ui-icon-disk" />
						</p:column>

					</p:dataTable>
					<!-- FIN: MODAL CON INFORMACIóN Y FILTROS VISTA ONLINE -->

					<h3>Tareas de la Actividad:</h3>

					<h:form>
						<p:commandButton styleClass="x-btn-text" icon="ui-icon-refresh" value="Re Cargar Archivos"
							action="divapProcesoAsignacionPerCapitaCargarValorizacion?faces-redirect=true" />
						<p:commandButton styleClass="x-btn-text" icon="ui-icon-refresh" value="Re Calcular Rebaja"
							action="divapProcesoAsignacionPerCapitaCargarValorizacion?faces-redirect=true" />
						<p:commandButton styleClass="x-btn-text" icon="ui-icon-check" value="Aceptar Rebaja Calculada"
							action="bandejaTareas?faces-redirect=true indexMenu=0" />
					</h:form>

				</p:panel>

				<p:commandButton value="Volver" styleClass="x-btn-text" action="bandejaTareas?faces-redirect=true indexMenu=0" ajax="false"
					icon="ui-icon-seek-first" />
			</p:panel>
		</h:form>
	</ui:define>
</ui:composition>