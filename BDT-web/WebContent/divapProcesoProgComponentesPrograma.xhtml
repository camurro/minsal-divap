<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html" xmlns:p="http://primefaces.org/ui" xmlns:fn="http://java.sun.com/jsp/jstl/functions" 	xmlns:c="http://java.sun.com/jsp/jstl/core" template="/WEB-INF/templates/emergente.xhtml">
<ui:define name="zonaJavaScript">
		<style type="text/css">
.ui-state-error {
	margin-left: 0px;
}
</style>
		<script type="text/javascript">

		function cambiaComboSubtituloComponente(){
			document.getElementById('tablaSubtitulos').style.display = 'block';
			//alert();
			document.getElementById('lblComponente').value = 'ola';
			//document.getElementById('form').submit();
			//alert($("#select13").val());
		}
	
		</script>
	</ui:define>

	<ui:define name="content">
		 
			<p:panel styleClass="contentPanel">
				<p:panel id="Panel">
					<h2>
						<strong>Tabla:</strong> Valorización por Peso Específico Componentes Programa
					</h2>
					<h:panelGrid>
						<h:form id ="more">
							<h:outputText value="Componente: " styleClass="inputLabel" />
											
							<p:selectOneMenu id="select5"  style="width:650px;" value="#{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.valorComboSubtituloComponente}">
	           			 		<f:selectItem itemLabel="Seleccione" itemValue="0" />
	            				<f:selectItems value="#{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.programa.componentes}" itemLabel="#{componente.nombre}" itemValue="#{componente.id}" var="componente" />
	            				<p:ajax listener="#{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.filtrarSubtituloComponente}" update=":formComponente"  />
	        				</p:selectOneMenu>
	        			 </h:form>
					</h:panelGrid>
					<br />
					<h:form id="formComponente">
					<ui:param name="numMesActual" value="#{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.numMesActual}" />
					<p:panelGrid columns="2" id="display" columnClasses="label,value">
						<div class="destacaArchivos ui-corner-all" style="padding: 10px;">
							<span class="strong">Componente: #{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.valorNombreComponente} </span> <br /> 
							<span class="strong">Peso Componente: 
								 #{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.valorPesoComponente}</span>
						</div>
					</p:panelGrid>
					<br />
					<h:panelGrid>
						<p:dataTable resizableColumns="true"
							value="#{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.estimacionFlujoMonitoreoSubtituloComponente}"
							liveResize="true" var="_data" rows="10" paginator="false"
							paginatorPosition="bottom"
							emptyMessage="No se encontro información."
							styleClass="dataTable" 
							id="tablaSubtitulo21">

						
							<c:if test="#{not procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.iniciarFlujoCaja}">
							<p:columnGroup type="header">
								<p:row>
									<p:column rowspan="3" headerText="Servicio" />
									<p:column
										colspan="#{fn:length(procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.columns) + 3}"
										styleClass="textoPequenio"
										headerText="#{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.subtituloSeleccionado.nombre} (Cuota #{mes} #{ano})" />
									<p:column rowspan="3" headerText="Total" />
								</p:row>
								<p:row>
									<p:column rowspan="2" headerText="Marco Presup." />
									<p:column rowspan="2"
										headerText="Transf. Acum. a la Fecha" width="200" />
									<p:column rowspan="2" headerText="Convenios Rec." />
									<!-- Columna de meses dinámicas  -->
									<c:forEach
										items="#{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.columns}"
										var="dynamicColumn">
										<p:column headerText="#{dynamicColumn.header}" />
									</c:forEach>
								</p:row>>
								<p:row>
									<c:forEach
										items="#{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.columns}"
										var="dynamicColumn">
										<p:column headerText="#{dynamicColumn.property}" />
									</c:forEach>
								</p:row>

							</p:columnGroup>
							
							<c:if test="#{not empty procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.estimacionFlujoMonitoreoSubtituloComponente}">

							<p:column>
								<span class="textoAjustado textoPequenio centrado">#{_data.servicio}</span>
							</p:column>
							<p:column>
								<h:outputText value="#{_data.marcoPresupuestario}"
									styleClass="textoPequenio textoAjustado">
									<f:convertNumber type="currency" maxFractionDigits="0"
										locale="es_CL" currencySymbol="$" />
								</h:outputText>
							</p:column>

							<p:column>
								<h:outputText value="#{_data.transferenciaAcumulada.monto}"
									styleClass="textoPequenio textoAjustado">
									<f:convertNumber type="currency" maxFractionDigits="0"
										locale="es_CL" currencySymbol="$" />
								</h:outputText>
							</p:column>
							<p:column>
								<h:outputText value="#{_data.convenioRecibido.monto}"
									styleClass="textoPequenio textoAjustado">
									<f:convertNumber type="currency" maxFractionDigits="0"
										locale="es_CL" currencySymbol="$" />
								</h:outputText>
							</p:column>

							<c:forEach items="#{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.cajaMonitoreoSubtituloComponentLocal}" var="monto">
								<c:if test="#{monto.idMes ge numMesActual}">
								<p:column>
										<h:outputText value="#{monto.montoMes}" styleClass="textoPequenio textoAjustado">
											<f:convertNumber type="currency" maxFractionDigits="0" locale="es_CL" currencySymbol="$" />
										</h:outputText>
								</p:column>
								</c:if>
							</c:forEach>

							<p:column style="background-color:#{_data.color};">
								<h:outputText value="#{_data.totalMontos}"
									styleClass="textoPequenio textoAjustado">
									<f:convertNumber type="currency" maxFractionDigits="0"
										locale="es_CL" currencySymbol="$" />
								</h:outputText>
							</p:column>

							<p:columnGroup type="footer">
								<p:row>
									<p:column />
									<p:column>
										<f:facet name="footer">
											<h:outputText value="#{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.totalServiciosMarcosPresupuestarioMonitoreoSubtituloComponente}" styleClass="textoAjustado textoPequenio centrado">
												<f:convertNumber type="currency" maxFractionDigits="0" locale="es_CL" currencySymbol="$" />
											</h:outputText>
										</f:facet>
									</p:column>
									<p:column>
										<f:facet name="footer">
											<h:outputText value="#{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.totalServiciosMontosTransferenciasMonitoreoSubtituloComponente}" styleClass="textoAjustado textoPequenio centrado">
												<f:convertNumber type="currency" maxFractionDigits="0" locale="es_CL" currencySymbol="$" />
											</h:outputText>
										</f:facet>
									</p:column>
									<p:column>
										<f:facet name="footer">
											<h:outputText value="#{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.totalServiciosMontosConveniosMonitoreoSubtituloComponente}"	styleClass="textoAjustado textoPequenio centrado">
												<f:convertNumber type="currency" maxFractionDigits="0" locale="es_CL" currencySymbol="$" />
											</h:outputText>
										</f:facet>
									</p:column>
									
									
									<c:forEach items="#{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.totalServiciosMontosMesMonitoreoSubtituloComponente}" var="montosMes" varStatus="status">
										<c:if test="#{status.count ge numMesActual}">
											<p:column>
												<f:facet name="footer">
													<h:outputText value="#{montosMes}" styleClass="textoAjustado textoPequenio centrado">
														<f:convertNumber type="currency" maxFractionDigits="0" locale="es_CL" currencySymbol="$" />
													</h:outputText>
												</f:facet>
											</p:column>
										</c:if>
									</c:forEach>
									
									<p:column>
										<f:facet name="footer">
											<h:outputText value="#{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.totalMontosMensualesServicioMonitoreoSubtituloComponente}" styleClass="textoAjustado textoPequenio centrado">
												<f:convertNumber type="currency" maxFractionDigits="0" locale="es_CL" currencySymbol="$" />
											</h:outputText>
										</f:facet>
									</p:column>
								</p:row>
							</p:columnGroup>
							</c:if>
							</c:if>
							<c:if test="#{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.iniciarFlujoCaja}">
							<p:columnGroup type="header">
								<p:row>
									<p:column rowspan="3" headerText="Servicio" />
									<p:column
										colspan="#{fn:length(procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.columns) + 1}"
										styleClass="textoPequenio"
										headerText="#{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.subtituloSeleccionado.nombre} (Cuota #{mes} #{ano})" />
									<p:column rowspan="3" headerText="Total" />
								</p:row>
								<p:row>
									<p:column rowspan="2" headerText="Marco Presup." />
									<c:forEach
										items="#{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.columns}"
										var="dynamicColumn">
										<p:column headerText="#{dynamicColumn.header}" />
									</c:forEach>
								</p:row>>
								<p:row>
									<c:forEach
										items="#{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.columns}"
										var="dynamicColumn">
										<p:column headerText="#{dynamicColumn.property}" />
									</c:forEach>
								</p:row>

							</p:columnGroup>
							
							<c:if test="#{not empty procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.estimacionFlujoMonitoreoSubtituloComponente}">

							<p:column>
								<span class="textoAjustado textoPequenio centrado">#{_data.servicio}</span>
							</p:column>
							<p:column>
								<h:outputText value="#{_data.marcoPresupuestario}"
									styleClass="textoPequenio textoAjustado">
									<f:convertNumber type="currency" maxFractionDigits="0"
										locale="es_CL" currencySymbol="$" />
								</h:outputText>
							</p:column>

							<c:forEach items="#{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.cajaMonitoreoSubtituloComponentLocal}" var="monto">
								<p:column>
										<h:outputText value="#{monto.montoMes}" styleClass="textoPequenio textoAjustado">
											<f:convertNumber type="currency" maxFractionDigits="0" locale="es_CL" currencySymbol="$" />
										</h:outputText>
								</p:column>
							</c:forEach>

							<p:column style="background-color:#{_data.color};">
								<h:outputText value="#{_data.totalMontos}"
									styleClass="textoPequenio textoAjustado">
									<f:convertNumber type="currency" maxFractionDigits="0"
										locale="es_CL" currencySymbol="$" />
								</h:outputText>
							</p:column>

							<p:columnGroup type="footer">
								<p:row>
									<p:column />
									<p:column>
										<f:facet name="footer">
											<h:outputText value="#{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.totalServiciosMarcosPresupuestarioMonitoreoSubtituloComponente}" styleClass="textoAjustado textoPequenio centrado">
												<f:convertNumber type="currency" maxFractionDigits="0" locale="es_CL" currencySymbol="$" />
											</h:outputText>
										</f:facet>
									</p:column>
									<c:forEach items="#{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.totalServiciosMontosMesMonitoreoSubtituloComponente}" var="montosMes" varStatus="status">
										<p:column>
											<f:facet name="footer">
												<h:outputText value="#{montosMes}" styleClass="textoAjustado textoPequenio centrado">
													<f:convertNumber type="currency" maxFractionDigits="0" locale="es_CL" currencySymbol="$" />
												</h:outputText>
											</f:facet>
										</p:column>
									</c:forEach>
									
									<p:column>
										<f:facet name="footer">
											<h:outputText value="#{procesoEstimacionFlujoCajaRevisarValidarMonitoreoController.totalMontosMensualesServicioMonitoreoSubtituloComponente}" styleClass="textoAjustado textoPequenio centrado">
												<f:convertNumber type="currency" maxFractionDigits="0" locale="es_CL" currencySymbol="$" />
											</h:outputText>
										</f:facet>
									</p:column>
								</p:row>
							</p:columnGroup>
							</c:if>
							</c:if>

						</p:dataTable>
					</h:panelGrid>
					</h:form>
			
			</p:panel>
			</p:panel>

	</ui:define>
</ui:composition>