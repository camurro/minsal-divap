<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html" xmlns:p="http://primefaces.org/ui" template="/WEB-INF/templates/default.xhtml"
                xmlns:c="http://java.sun.com/jsp/jstl/core" 
                xmlns:fn="http://java.sun.com/jsp/jstl/functions"
                 >

	<ui:define name="content">
	
	<h:form enctype="multipart/form-data" id="form"   >

	<p:growl id="msgs" showDetail="true"/>
			<p:panel styleClass="contentPanel">
				<h1>
					<h:outputText value="Órdenes de Transferencia | Revisión del Profesional" />
				</h1>
				<p:panel id="Panel">
					<h2>Programa: #{procesoOTRevisarAntecedentesController.programa.nombre}</h2>
					<p class="parrafo">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent egestas tempor nulla eget ultricies. Morbi
						pulvinar elit at justo pharetra, vitae ultricies est dignissim, justo nisi porttitor enim, eget ullamcorper felis augue eget lacus.</p>
					<br />
					<h3>Filtros del Programa:</h3>
					<h:panelGrid id="busqueda_mis_tareas" columns="5">
					<c:if test="#{not procesoOTRevisarAntecedentesController.percapita}">
						<h:panelGrid columns="2">
								<h:outputText value="Componente " styleClass="inputLabel" />
								<p:selectOneMenu id="componentes"  value="#{procesoOTRevisarAntecedentesController.componenteSeleccionado}">
								<f:selectItem itemLabel="Seleccione" itemValue="" />  
								<f:selectItems value="#{procesoOTRevisarAntecedentesController.listaComponentes}" itemLabel="#{componente.nombre}" var="componente" itemValue="#{componente.id}"/> 
							</p:selectOneMenu>
							</h:panelGrid>
					</c:if>
							<h:panelGrid columns="2">
								<h:outputText value="Servicio: " styleClass="inputLabel" />
								<p:selectOneMenu id="servicios"  value="#{procesoOTRevisarAntecedentesController.servicioSeleccionado}">
								<f:selectItem itemLabel="Seleccione" itemValue="" />  
								<f:selectItems value="#{procesoOTRevisarAntecedentesController.listaServicios}" itemLabel="#{servicio.nombre_servicio}" var="servicio" itemValue="#{servicio.id_servicio}"/> 
							</p:selectOneMenu>
							</h:panelGrid>
						
						<h:panelGrid columns="1">
							<p:commandButton value="Buscar" id="buscarListado" styleClass="x-btn-text" icon="ui-icon-search" actionListener="#{procesoOTRevisarAntecedentesController.buscarResultados}" update="form:tabs"/>
						</h:panelGrid>
					</h:panelGrid>
					<p:tabView id="tabs">
					<c:if test="#{not procesoOTRevisarAntecedentesController.percapita}">
						<c:if test="#{procesoOTRevisarAntecedentesController.subtitulo24}">
							<p:tab title="Subtítulo 24" id="tabS24">
								<p:dataTable resizableColumns="true" value="#{procesoOTRevisarAntecedentesController.resultadoMunicipal}" liveResize="true" var="detalleS24"
										rows="10" paginator="false" paginatorPosition="bottom" emptyMessage="No se encontro información." 
										styleClass="dataTable" id="tablaResultadosS24" rowIndexVar="rowIndex">
										<p:columnGroup type="header">
											<p:row>
												<p:column rowspan="3" headerText="Comuna" />
												<p:column rowspan="3" headerText="Marco Presupuestario"/>
												<p:column colspan="2" rowspan="2" headerText="Transferencia Acumulada a la Fecha"/>
												<p:column colspan="2" rowspan="2" headerText="Convenios Recibidos"/>
												<c:forEach items="#{procesoOTRevisarAntecedentesController.remesasPrograma}" var="remesa">
													<p:column rowspan="1" colspan="#{remesa.cantDias}" headerText="#{remesa.mes}"/>
												</c:forEach>
												<p:column colspan="2" rowspan="2" headerText="Marco - Remesa Acumulada"/>
												<p:column rowspan="3" headerText="Revisado"/>
											</p:row>
											<p:row>
												<c:forEach items="#{procesoOTRevisarAntecedentesController.remesasPrograma}" var="remesa">
													<p:column rowspan="1" colspan="#{remesa.cantDias}" headerText="Días de Remesa"/>
												</c:forEach>
												
											</p:row>
											<p:row>
												<p:column headerText="Monto" />
												<p:column headerText="%" />
												<p:column headerText="Monto" />
												<p:column headerText="%" />
												<c:forEach items="#{procesoOTRevisarAntecedentesController.remesasPrograma}" var="remesa">
													<c:forEach items="#{remesa.dias}" var="dia">
														<p:column headerText="#{dia.dia}"/>
													</c:forEach>
												</c:forEach>
												<p:column headerText="Monto" />
												<p:column headerText="%" />
											</p:row>
										</p:columnGroup>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS24.comuna.nombre}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS24.comuna.nombre}</span>
										</p:column>
										
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS24.comuna.nombre}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS24.comuna.nombre}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS24.comuna.nombre}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS24.comuna.nombre}</span>
										</p:column>
										<c:forEach items="#{procesoOTRevisarAntecedentesController.remesasPrograma}" var="remesa">
											<c:forEach items="#{remesa.dias}" var="dia">
													<p:column>
														<c:if test="#{dia.bloqueado}">
															<h:outputText value="bloqueado" /> 
														</c:if>
														<c:if test="#{not dia.bloqueado}">
															OK
														</c:if>
													</p:column>
											</c:forEach>
										</c:forEach>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS24.comuna.nombre}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS24.comuna.nombre}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS24.comuna.nombre}</span>
										</p:column>
									</p:dataTable>
							</p:tab>
						</c:if>
						<c:if test="#{procesoOTRevisarAntecedentesController.subtitulo21}">
							<p:tab title="Subtítulo 21" id="tabS21">
									<p:dataTable resizableColumns="true" value="#{procesoOTRevisarAntecedentesController.resultadoServicioSub21}" liveResize="true" var="detalleS21"
										rows="10" paginator="false" paginatorPosition="bottom" emptyMessage="No se encontro información." 
										styleClass="dataTable" id="tablaResultadosS21" rowIndexVar="rowIndex">
										<p:columnGroup type="header">
											<p:row>
												<p:column rowspan="3" headerText="Establecimiento" />
												<p:column rowspan="3" headerText="Marco Presupuestario"/>
												<p:column colspan="2" rowspan="2" headerText="Transferencia Acumulada a la Fecha"/>
												<p:column colspan="2" rowspan="2" headerText="Convenios Recibidos"/>
												<c:forEach items="#{procesoOTRevisarAntecedentesController.remesasPrograma}" var="remesa">
													<p:column rowspan="1" colspan="#{remesa.cantDias}" headerText="#{remesa.mes}"/>
												</c:forEach>
												<p:column colspan="2" rowspan="2" headerText="Marco - Remesa Acumulada"/>
												<p:column rowspan="3" headerText="Revisado"/>
											</p:row>
											<p:row>
												<c:forEach items="#{procesoOTRevisarAntecedentesController.remesasPrograma}" var="remesa">
													<p:column rowspan="1" colspan="#{remesa.cantDias}" headerText="Días de Remesa"/>
												</c:forEach>
												
											</p:row>
											<p:row>
												<p:column headerText="Monto" />
												<p:column headerText="%" />
												<p:column headerText="Monto" />
												<p:column headerText="%" />
												<c:forEach items="#{procesoOTRevisarAntecedentesController.remesasPrograma}" var="remesa">
													<c:forEach items="#{remesa.dias}" var="dia">
														<p:column headerText="#{dia.dia}"/>
													</c:forEach>
												</c:forEach>
												<p:column headerText="Monto" />
												<p:column headerText="%" />
											</p:row>
										</p:columnGroup>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS21.establecimiento.nombre}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS21.marcoPresupuestario}</span>
										</p:column>
										
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS21.transferenciaAcumulada}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS21.porcentajeTransferencia}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS21.conveniosRecibidos}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS21.porcentajeConveniosRecibidos}</span>
										</p:column>
										<c:forEach items="#{procesoOTRevisarAntecedentesController.remesasPrograma}" var="remesa">
											<c:forEach items="#{remesa.dias}" var="dia">
													<p:column>
														<c:if test="#{dia.bloqueado}">
															<h:outputText value="bloqueado" /> 
														</c:if>
														<c:if test="#{not dia.bloqueado}">
															OK
														</c:if>
													</p:column>
											</c:forEach>
										</c:forEach>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS21.establecimiento.nombre}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS21.establecimiento.nombre}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS21.establecimiento.nombre}</span>
										</p:column>
									</p:dataTable>
							</p:tab>
						</c:if>
						<c:if test="#{procesoOTRevisarAntecedentesController.subtitulo22}">
							<p:tab title="Subtítulo 22" id="tabS22">
								<p:dataTable resizableColumns="true" value="#{procesoOTRevisarAntecedentesController.resultadoServicioSub22}" liveResize="true" var="detalleS22"
										rows="10" paginator="false" paginatorPosition="bottom" emptyMessage="No se encontro información." 
										styleClass="dataTable" id="tablaResultadosS22" rowIndexVar="rowIndex">
										<p:columnGroup type="header">
											<p:row>
												<p:column rowspan="3" headerText="Establecimiento" />
												<p:column rowspan="3" headerText="Marco Presupuestario"/>
												<p:column colspan="2" rowspan="2" headerText="Transferencia Acumulada a la Fecha"/>
												<p:column colspan="2" rowspan="2" headerText="Convenios Recibidos"/>
												<c:forEach items="#{procesoOTRevisarAntecedentesController.remesasPrograma}" var="remesa">
													<p:column rowspan="1" colspan="#{remesa.cantDias}" headerText="#{remesa.mes}"/>
												</c:forEach>
												<p:column colspan="2" rowspan="2" headerText="Marco - Remesa Acumulada"/>
												<p:column rowspan="3" headerText="Revisado"/>
											</p:row>
											<p:row>
												<c:forEach items="#{procesoOTRevisarAntecedentesController.remesasPrograma}" var="remesa">
													<p:column rowspan="1" colspan="#{remesa.cantDias}" headerText="Días de Remesa"/>
												</c:forEach>
												
											</p:row>
											<p:row>
												<p:column headerText="Monto" />
												<p:column headerText="%" />
												<p:column headerText="Monto" />
												<p:column headerText="%" />
												<c:forEach items="#{procesoOTRevisarAntecedentesController.remesasPrograma}" var="remesa">
													<c:forEach items="#{remesa.dias}" var="dia">
														<p:column headerText="#{dia.dia}"/>
													</c:forEach>
												</c:forEach>
												<p:column headerText="Monto" />
												<p:column headerText="%" />
											</p:row>
										</p:columnGroup>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS22.establecimiento.nombre}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS22.marcoPresupuestario}</span>
										</p:column>
										
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS22.transferenciaAcumulada}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS22.porcentajeTransferencia}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS22.conveniosRecibidos}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS22.porcentajeConveniosRecibidos}</span>
										</p:column>
										<c:forEach items="#{procesoOTRevisarAntecedentesController.remesasPrograma}" var="remesa">
											<c:forEach items="#{remesa.dias}" var="dia">
													<p:column>
														<c:if test="#{dia.bloqueado}">
															<h:outputText value="bloqueado" /> 
														</c:if>
														<c:if test="#{not dia.bloqueado}">
															OK
														</c:if>
													</p:column>
											</c:forEach>
										</c:forEach>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS22.establecimiento.nombre}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS22.establecimiento.nombre}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS22.establecimiento.nombre}</span>
										</p:column>
									</p:dataTable>
							</p:tab>
						</c:if>
						<c:if test="#{procesoOTRevisarAntecedentesController.subtitulo29}">
							<p:tab title="Subtítulo 29" id="tabS29">
								<p:dataTable resizableColumns="true" value="#{procesoOTRevisarAntecedentesController.resultadoServicioSub29}" liveResize="true" var="detalleS29"
										rows="10" paginator="false" paginatorPosition="bottom" emptyMessage="No se encontro información." 
										styleClass="dataTable" id="tablaResultadosS29" rowIndexVar="rowIndex">
										<p:columnGroup type="header">
											<p:row>
												<p:column rowspan="3" headerText="Establecimiento" />
												<p:column rowspan="3" headerText="Marco Presupuestario ($)"/>
												<p:column colspan="2" rowspan="2" headerText="Transferencia Acumulada a la Fecha"/>
												<p:column colspan="2" rowspan="2" headerText="Convenios Recibidos"/>
												<c:forEach items="#{procesoOTRevisarAntecedentesController.remesasPrograma}" var="remesa">
													<p:column rowspan="1" colspan="#{remesa.cantDias}" headerText="#{remesa.mes}"/>
												</c:forEach>
												<p:column colspan="2" rowspan="2" headerText="Marco - Remesa Acumulada"/>
												<p:column rowspan="3" headerText="Revisado"/>
											</p:row>
											<p:row>
												<c:forEach items="#{procesoOTRevisarAntecedentesController.remesasPrograma}" var="remesa">
													<p:column rowspan="1" colspan="#{remesa.cantDias}" headerText="Días de Remesa"/>
												</c:forEach>
												
											</p:row>
											<p:row>
												<p:column headerText="Monto ($)" />
												<p:column headerText="%" />
												<p:column headerText="Monto ($)" />
												<p:column headerText="%" />
												<c:forEach items="#{procesoOTRevisarAntecedentesController.remesasPrograma}" var="remesa">
													<c:forEach items="#{remesa.dias}" var="dia">
														<p:column headerText="#{dia.dia}"/>
													</c:forEach>
												</c:forEach>
												<p:column headerText="Monto ($)" />
												<p:column headerText="%" />
											</p:row>
										</p:columnGroup>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS29.establecimiento.nombre}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS29.marcoPresupuestario}</span>
										</p:column>
										
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS29.transferenciaAcumulada}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS29.porcentajeTransferencia}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS29.conveniosRecibidos}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS29.porcentajeConveniosRecibidos}</span>
										</p:column>
										<c:forEach items="#{procesoOTRevisarAntecedentesController.remesasPrograma}" var="remesa">
											<c:forEach items="#{remesa.dias}" var="dia">
													<p:column>
														<c:if test="#{dia.bloqueado}">
															<h:outputText value="bloqueado" /> 
														</c:if>
														<c:if test="#{not dia.bloqueado}">
															OK
														</c:if>
													</p:column>
											</c:forEach>
										</c:forEach>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS29.establecimiento.nombre}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS29.establecimiento.nombre}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detalleS29.establecimiento.nombre}</span>
										</p:column>
									</p:dataTable>
							
							</p:tab>
						</c:if>
						</c:if>
						<c:if test="#{procesoOTRevisarAntecedentesController.percapita}">
							<p:tab title="Per Cápita" id="tabPerCapita">
								<p:dataTable resizableColumns="true" value="#{procesoOTRevisarAntecedentesController.resultadoPercapita}" liveResize="true" var="detallePercapita"
										rows="10" paginator="false" paginatorPosition="bottom" emptyMessage="No se encontro información." 
										styleClass="dataTable" id="tablaResultadosPercapita" rowIndexVar="rowIndex">
										<p:columnGroup type="header">
											<p:row>
												<p:column rowspan="3" headerText="Comuna" />
												<p:column rowspan="3" headerText="Clasificación" />
												<p:column rowspan="3" headerText="Marco Presupuestario ($)"/>
												<p:column colspan="2" rowspan="2" headerText="Remesa Acumulada a la Fecha"/>
												<c:forEach items="#{procesoOTRevisarAntecedentesController.remesasPrograma}" var="remesa">
													<p:column rowspan="1" colspan="#{remesa.cantDias}" headerText="#{remesa.mes}"/>
												</c:forEach>
												<p:column colspan="2" rowspan="2" headerText="Marco - Remesa Acumulada"/>
												<p:column rowspan="3" headerText="Revisado"/>
											</p:row>
											<p:row>
												<c:forEach items="#{procesoOTRevisarAntecedentesController.remesasPrograma}" var="remesa">
													<p:column rowspan="1" colspan="#{remesa.cantDias}" headerText="Días de Remesa"/>
												</c:forEach>
												
											</p:row>
											<p:row>
												<p:column headerText="Monto ($)" />
												<p:column headerText="%" />
												<c:forEach items="#{procesoOTRevisarAntecedentesController.remesasPrograma}" var="remesa">
													<c:forEach items="#{remesa.dias}" var="dia">
														<p:column headerText="#{dia.dia}"/>
													</c:forEach>
												</c:forEach>
												<p:column headerText="Monto ($)" />
												<p:column headerText="%" />
											</p:row>
										</p:columnGroup>
											<p:column>
											<span class="textoAjustado textoPequenio">#{detallePercapita.comuna}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detallePercapita.tipoComuna}</span>
										</p:column>
										<p:column>
											<h:outputText styleClass="textoAjustado textoPequenio" value="#{detallePercapita.marcoPresupuestario}">
												<f:convertNumber  maxFractionDigits="0"/>
											</h:outputText>
										</p:column>
										
										<p:column>
											<h:outputText styleClass="textoAjustado textoPequenio" value="#{detallePercapita.transferenciaAcumulada}">
												<f:convertNumber  maxFractionDigits="0"/>
											</h:outputText>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detallePercapita.porcentajeTransferenciaAcumulada}</span>
										</p:column>
										<c:forEach items="#{detallePercapita.remesas}" var="remesa">
											<c:forEach items="#{remesa.dias}" var="dia">
													<p:column>
														<c:if test="#{dia.bloqueado}">
															<h:outputText value="#{dia.monto}" styleClass="textoAjustado textoPequenio">
																<f:convertNumber  maxFractionDigits="0"/>
															</h:outputText> 
														</c:if>
														<c:if test="#{not dia.bloqueado}">
															<h:inputText value="#{dia.monto}" styleClass="divapProcesoOTInput">
																<f:convertNumber  maxFractionDigits="0"/>
															</h:inputText> 
														</c:if>
													</p:column>
											</c:forEach>
										</c:forEach>
										<p:column>
											<h:outputText styleClass="textoAjustado textoPequenio" value="#{detallePercapita.diferencia}">
												<f:convertNumber  maxFractionDigits="0"/>
											</h:outputText>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">#{detallePercapita.porcentajeDiferencia}</span>
										</p:column>
										<p:column>
											<span class="textoAjustado textoPequenio">77</span>
										</p:column>
									</p:dataTable>
								
							</p:tab>
						</c:if>
					</p:tabView>
	
				</p:panel>
				<p:commandButton value="Volver" styleClass="x-btn-text" action="bandejaTareas?faces-redirect=true indexMenu=0" ajax="false"
					icon="ui-icon-seek-first" />
			</p:panel>
		</h:form>
	</ui:define>
</ui:composition>