<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html" xmlns:p="http://primefaces.org/ui" template="/WEB-INF/templates/default.xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core" 
                xmlns:fn="http://java.sun.com/jsp/jstl/functions"
                xmlns:a4j="http://richfaces.org/a4j"
                xmlns:t="http://primefaces.org/ui">

<ui:define name="zonaJavaScript">
		<style type="text/css">
			.ui-state-error {
				margin-left: 0px;
			}
		</style>
		<script type="text/javascript">
		function actualizarTabla() {  
			document.getElementById("form:botonActualizar").click();
		}

		function actualizarHidden(fila,dia,mes,id,subtitulo) {  
			$("#form2\\:fila").val(fila);
			$("#form2\\:dia").val(dia);
			$("#form2\\:mes").val(mes);
			$("#form2\\:subtitulo").val(subtitulo);
			$("#form2\\:monto").val(document.getElementById(id).value);
			document.getElementById("form2:botonActualizar").click();
		}

		
		</script>
	</ui:define>
	<ui:define name="content">
		<h:form enctype="multipart/form-data" id="form">
		<p:commandButton id="botonActualizar" value="actualiza" update="form:tabViewConsolidado:resumenProgramas form:tabViewConsolidado:tabViewSubtitulos:tablaFonasaS21 form:tabViewConsolidado:tabViewSubtitulos:tablaFonasaS22 form:tabViewConsolidado:tabViewSubtitulos:tablaFonasaS29 form:tabViewConsolidado:tabViewSubtitulos:tablaFonasaS24" style="display: none" action="#{procesoOTRevisarConsolidacionController.actualizar}"/>
			<p:panel styleClass="contentPanel">
				<h1>
					<h:outputText value="Ordenes de Transferencia" />
				</h1>
					<h2>Consolidado de Ordenes de Transferencia para el mes de #{procesoOTRevisarConsolidacionController.mesActual}</h2>
					<p class="parrafo">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent egestas tempor nulla eget ultricies. Morbi
						pulvinar elit at justo pharetra, vitae ultricies est dignissim, justo nisi porttitor enim, eget ullamcorper felis augue eget lacus.</p>
					<br />
					<h:panelGrid columns="2">
						<h:graphicImage value="resources/minsal/images/search.png" styleClass="divapIcons" />
						<p:lightBox iframe="true" width="950px" id="resumen">
							<h:outputLink value="divapProcesoOTProgramasMonitoreados.jsf">Monitoreo de Programas</h:outputLink>
						</p:lightBox>
					</h:panelGrid>
					<br />
					
					<div id="tablaSubtitulos" style="display: block;">
						<br />
						<p:tabView id="tabViewConsolidado"  activeIndex="#{procesoOTRevisarConsolidacionController.activeTab}" dynamic="true" cache="false">
							<p:tab id="tab11" title="Resumen Consolidado (formato FONASA)">
								<p:tabView id="tabViewSubtitulos">
									<p:tab id="s21" title="Subtítulo 21">
										<p:dataTable resizableColumns="true" value="#{procesoOTRevisarConsolidacionController.resumenFonasaServicioS21}" liveResize="true" var="fonasaS21"
												rows="10" paginator="true" paginatorPosition="bottom" emptyMessage="No se encontro información." 
												styleClass="dataTable" id="tablaFonasaS21" rowIndexVar="rowIndexFonasaS21">
												<p:columnGroup type="header">
													<p:row>
														<p:column headerText="Servicio de Salud"/>
														<c:forEach items="#{procesoOTRevisarConsolidacionController.encabezadoFonasa}" var="encabezado">
															<p:column headerText="#{encabezado.nombrePrograma}"/>
														</c:forEach>
														<p:column headerText="Otros Programas Subtítulo 21"/>
														<p:column headerText="Total Ref. Servicios Subtítulo 21"/>
													</p:row>
												</p:columnGroup>
												<p:column>
													<span class="textoAjustado textoPequenio">#{fonasaS21.nombreServicio}</span>
												</p:column>
												<c:forEach items="#{fonasaS21.programasFonasa}" var="progFonasa">
												<p:column>
													<h:outputText value="#{progFonasa.monto}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												</c:forEach>
												<p:column>
													<h:outputText value="#{fonasaS21.totalOtrosProgramas}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												<p:column>
													<h:outputText value="#{fonasaS21.total}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
										</p:dataTable>									
									</p:tab>
									<p:tab id="s22" title="Subtítulo 22">
										<p:dataTable resizableColumns="true" value="#{procesoOTRevisarConsolidacionController.resumenFonasaServicioS22}" liveResize="true" var="fonasaS22"
												rows="10" paginator="true" paginatorPosition="bottom" emptyMessage="No se encontro información." 
												styleClass="dataTable" id="tablaFonasaS22" rowIndexVar="rowIndexFonasaS22">
												<p:columnGroup type="header">
													<p:row>
														<p:column headerText="Servicio de Salud"/>
														<c:forEach items="#{procesoOTRevisarConsolidacionController.encabezadoFonasa}" var="encabezado">
															<p:column headerText="#{encabezado.nombrePrograma}"/>
														</c:forEach>
														<p:column headerText="Otros Programas Subtítulo 22"/>
														<p:column headerText="Total Ref. Servicios Subtítulo 22"/>
													</p:row>
												</p:columnGroup>
												<p:column>
													<span class="textoAjustado textoPequenio">#{fonasaS22.nombreServicio}</span>
												</p:column>
												<c:forEach items="#{fonasaS22.programasFonasa}" var="progFonasa">
												<p:column>
													<h:outputText value="#{progFonasa.monto}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												</c:forEach>
												<p:column>
													<h:outputText value="#{fonasaS22.totalOtrosProgramas}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												<p:column>
												<h:outputText value="#{fonasaS22.total}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
										</p:dataTable>		
									</p:tab>
									<p:tab id="s29" title="Subtítulo 29">
										<p:dataTable resizableColumns="true" value="#{procesoOTRevisarConsolidacionController.resumenFonasaServicioS29}" liveResize="true" var="fonasaS29"
												rows="10" paginator="true" paginatorPosition="bottom" emptyMessage="No se encontro información." 
												styleClass="dataTable" id="tablaFonasaS29" rowIndexVar="rowIndexFonasaS29">
												<p:columnGroup type="header">
													<p:row>
														<p:column headerText="Servicio de Salud"/>
														<c:forEach items="#{procesoOTRevisarConsolidacionController.encabezadoFonasa}" var="encabezado">
															<p:column headerText="#{encabezado.nombrePrograma}"/>
														</c:forEach>
														<p:column headerText="Otros Programas Subtítulo 29"/>
														<p:column headerText="Total Ref. Servicios Subtítulo 29"/>
													</p:row>
												</p:columnGroup>
												<p:column>
													<span class="textoAjustado textoPequenio">#{fonasaS29.nombreServicio}</span>
												</p:column>
												<c:forEach items="#{fonasaS29.programasFonasa}" var="progFonasa">
													<p:column>
													<h:outputText value="#{progFonasa.monto}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												</c:forEach>
												<p:column>
													<span class="textoAjustado textoPequenio">#{fonasaS29.totalOtrosProgramas}</span>
												</p:column>
												<p:column>
													<span class="textoAjustado textoPequenio">#{fonasaS29.total}</span>
												</p:column>
										</p:dataTable>	
									</p:tab>
									<p:tab id="s24" title="Subtítulo 24">
										<p:dataTable resizableColumns="true" value="#{procesoOTRevisarConsolidacionController.resumenFonasaMunicipalS24}" liveResize="true" var="fonasaS24"
												rows="10" paginator="true" paginatorPosition="bottom" emptyMessage="No se encontro información." 
												styleClass="dataTable" id="tablaFonasaS24" rowIndexVar="rowIndexFonasaS24">
												<p:columnGroup type="header">
													<p:row>
														<p:column headerText="Servicio de Salud"/>
														<!-- PERCAPITAS -->
														<p:column headerText="Per Cápita Basal"/>
														<p:column headerText="ADDF"/>
														<p:column headerText="Descto. Retiro"/>
														<p:column headerText="Rebaja IAAPS"/>
														<p:column headerText="Total Per Cápita"/>
														
														<c:forEach items="#{procesoOTRevisarConsolidacionController.encabezadoFonasa}" var="encabezado">
															<p:column headerText="#{encabezado.nombrePrograma}"/>
														</c:forEach>
														<p:column headerText="Otros Programas Subtítulo 24"/>
														<p:column headerText="Total Ref. Servicios Subtítulo 24"/>
													</p:row>
												</p:columnGroup>
												<p:column>
													<span class="textoAjustado textoPequenio">#{fonasaS24.nombreServicio}</span>
												</p:column>
												<p:column>
													<h:outputText value="#{fonasaS24.perCapitaBasal}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												<p:column>
													<h:outputText value="#{fonasaS24.desempenoDificil}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												<p:column>
													<h:outputText value="#{fonasaS24.descuentoRetiro}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												<p:column>
													<h:outputText value="#{fonasaS24.rebaja}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												<p:column>
													<h:outputText value="#{fonasaS24.totalPercapita}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												<c:forEach items="#{fonasaS24.programasFonasa}" var="progFonasa">
													<p:column>
													<h:outputText value="#{progFonasa.monto}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												</c:forEach>
												<p:column>
													<h:outputText value="#{fonasaS24.totalOtrosProgramas}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												<p:column>
													<h:outputText value="#{fonasaS24.total}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
										</p:dataTable>	
									</p:tab>
									
								</p:tabView>
							</p:tab>
							<p:tab id="tab22" title="Detalle Programas">
								<h:panelGrid columns="2">
									<h:outputText value="Servicio: " styleClass="inputLabel" />
									<p:selectOneMenu id="servicios"  value="#{procesoOTRevisarConsolidacionController.servicioSeleccionado}">
										<f:selectItem itemLabel="Seleccione" itemValue="" />  
										<f:selectItems value="#{procesoOTRevisarConsolidacionController.listaServicios}" itemLabel="#{servicio.nombre_servicio}" var="servicio" itemValue="#{servicio.id_servicio}"/> 
									</p:selectOneMenu>
								</h:panelGrid>
									<h:outputText value="Programa: " styleClass="inputLabel" />
									<p:selectOneMenu id="programas"  value="#{procesoOTRevisarConsolidacionController.programaSeleccionado}">
										<f:selectItem itemLabel="Seleccione" itemValue="" />  
										<f:selectItems value="#{procesoOTRevisarConsolidacionController.listaProgramas}" itemLabel="#{programa.nombre}" var="programa" itemValue="#{programa.idProgramaAno}"/>
										<p:ajax listener="#{procesoOTRevisarConsolidacionController.cargaComponentes}" update=":form:tabViewConsolidado:componentes"/> 
									</p:selectOneMenu>
								<h:panelGrid columns="2">
									<h:outputText value="Componente " styleClass="inputLabel" />
									<p:selectOneMenu id="componentes"  value="#{procesoOTRevisarConsolidacionController.componenteSeleccionado}">
										<f:selectItem itemLabel="Seleccione" itemValue="" />  
										<f:selectItems value="#{procesoOTRevisarConsolidacionController.listaComponentes}" itemLabel="#{componente.nombre}" var="componente" itemValue="#{componente.id}"/> 
									</p:selectOneMenu>
									
									<p:commandButton value="Buscar" id="buscarListado" styleClass="x-btn-text" icon="ui-icon-search" actionListener="#{procesoOTRevisarConsolidacionController.buscarDetallePrograma}" update=":form:tabViewConsolidado:resumenProgramas" oncomplete="actualizarTabla();"/>
								</h:panelGrid>

									<br />
								<p:tabView id="resumenProgramas">
									<c:if test="#{procesoOTRevisarConsolidacionController.subtitulo21}">
										<p:tab title="Subtítulo 21">
											<p:dataTable resizableColumns="true" value="#{procesoOTRevisarConsolidacionController.resultadoServicioSub21}" liveResize="true" var="detalleS21"
												rows="10" paginator="false" paginatorPosition="bottom" emptyMessage="No se encontro información." 
												styleClass="dataTable" id="tablaResultadosS21" rowIndexVar="rowIndexS21">
												<p:columnGroup type="header">
													<p:row>
														<p:column rowspan="3" headerText="Establecimiento" />
														<p:column rowspan="3" headerText="Marco Presupuestario"/>
														<p:column colspan="2" rowspan="2" headerText="Remesa Acumulada a la Fecha"/>
														<p:column colspan="2" rowspan="2" headerText="Convenios Recibidos"/>
														<c:forEach items="#{procesoOTRevisarConsolidacionController.remesasPrograma}" var="remesa">
															<p:column rowspan="1" colspan="#{remesa.cantDias}" headerText="#{remesa.mes}"/>
														</c:forEach>
														<p:column colspan="2" rowspan="2" headerText="Marco - Remesa Acumulada"/>
														<p:column rowspan="3" headerText="Revisado"/>
													</p:row>
													<p:row>
														<c:forEach items="#{procesoOTRevisarConsolidacionController.remesasPrograma}" var="remesa">
															<p:column rowspan="1" colspan="#{remesa.cantDias}" headerText="Días de Remesa"/>
														</c:forEach>
														
													</p:row>
													<p:row>
														<p:column headerText="Monto" />
														<p:column headerText="%" />
														<p:column headerText="Monto" />
														<p:column headerText="%" />
														<c:forEach items="#{procesoOTRevisarConsolidacionController.remesasPrograma}" var="remesa">
															<c:forEach items="#{remesa.dias}" var="dia">
																<p:column headerText="#{dia.dia}"/>
															</c:forEach>
														</c:forEach>
														<p:column headerText="Monto" />
														<p:column headerText="%" />
													</p:row>
												</p:columnGroup>
												<p:column>
													<span class="textoAjustado textoPequenio">#{detalleS21.establecimiento.nombre}</span>
												</p:column>
												<p:column>
													<h:outputText value="#{detalleS21.marcoPresupuestario}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												
												<p:column>
													<h:outputText value="#{detalleS21.transferenciaAcumulada}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												<p:column>
													<span class="textoAjustado textoPequenio">#{detalleS21.porcentajeTransferencia}</span>
												</p:column>
												<p:column>
													<h:outputText value="#{detalleS21.conveniosRecibidos}" styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												<p:column>
													<span class="textoAjustado textoPequenio">#{detalleS21.porcentajeConveniosRecibidos}</span>
												</p:column>
												<c:forEach items="#{detalleS21.remesas}" var="remesa">
													<c:forEach items="#{remesa.dias}" var="dia">
															<p:column>
																<c:if test="#{dia.bloqueado}">
																	<h:outputText value="#{dia.monto}" styleClass="textoAjustado textoPequenio">
																		<f:convertNumber  maxFractionDigits="0"/>
																	</h:outputText> 
																</c:if>
																<c:if test="#{not dia.bloqueado}">
																	<p:inputText value="#{dia.monto}" styleClass="divapProcesoOTProgramaInput" onblur="actualizarHidden(#{rowIndexS21},#{dia.dia},#{remesa.idMes},this.id,21);">
																					<f:convertNumber  maxFractionDigits="0"/>
																	</p:inputText> 
																</c:if>
															</p:column>
													</c:forEach>
												</c:forEach>
												<p:column>
													<h:outputText value="#{detalleS21.diferencia}" styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												<p:column>
													<span class="textoAjustado textoPequenio">#{detalleS21.porcentajeDiferencia}</span>
												</p:column>
												<p:column>
													<p:selectBooleanCheckbox rendered="#{not detalleS21.aprobado}" value="#{detalleS21.aprobado}">
										            	<p:ajax update=":form:tabViewConsolidado:resumenProgramas:tablaResultadosS21" listener="#{procesoOTRevisarConsolidacionController.actualizarS21(rowIndexS21, detalleS21.establecimiento.codigoEstablecimiento)}"/>
										        	</p:selectBooleanCheckbox>
													<h:graphicImage rendered="#{detalleS21.aprobado}" value="resources/minsal/images/check-green.png" styleClass="divapIcons" />	
												</p:column>
											</p:dataTable>
										</p:tab>
									</c:if>
									<c:if test="#{procesoOTRevisarConsolidacionController.subtitulo22}">
										<p:tab title="Subtítulo 22">
											<p:dataTable resizableColumns="true" value="#{procesoOTRevisarConsolidacionController.resultadoServicioSub22}" liveResize="true" var="detalleS22"
												rows="10" paginator="false" paginatorPosition="bottom" emptyMessage="No se encontro información." 
												styleClass="dataTable" id="tablaResultadosS22" rowIndexVar="rowIndexS22">
												<p:columnGroup type="header">
													<p:row>
														<p:column rowspan="3" headerText="Establecimiento" />
														<p:column rowspan="3" headerText="Marco Presupuestario"/>
														<p:column colspan="2" rowspan="2" headerText="Remesa Acumulada a la Fecha"/>
														<p:column colspan="2" rowspan="2" headerText="Convenios Recibidos"/>
														<c:forEach items="#{procesoOTRevisarConsolidacionController.remesasPrograma}" var="remesa">
															<p:column rowspan="1" colspan="#{remesa.cantDias}" headerText="#{remesa.mes}"/>
														</c:forEach>
														<p:column colspan="2" rowspan="2" headerText="Marco - Remesa Acumulada"/>
														<p:column rowspan="3" headerText="Revisado"/>
													</p:row>
													<p:row>
														<c:forEach items="#{procesoOTRevisarConsolidacionController.remesasPrograma}" var="remesa">
															<p:column rowspan="1" colspan="#{remesa.cantDias}" headerText="Días de Remesa"/>
														</c:forEach>
														
													</p:row>
													<p:row>
														<p:column headerText="Monto" />
														<p:column headerText="%" />
														<p:column headerText="Monto" />
														<p:column headerText="%" />
														<c:forEach items="#{procesoOTRevisarConsolidacionController.remesasPrograma}" var="remesa">
															<c:forEach items="#{remesa.dias}" var="dia">
																<p:column headerText="#{dia.dia}"/>
															</c:forEach>
														</c:forEach>
														<p:column headerText="Monto" />
														<p:column headerText="%" />
													</p:row>
												</p:columnGroup>
												<p:column>
													<span class="textoAjustado textoPequenio">#{detalleS22.establecimiento.nombre}</span>
												</p:column>
												<p:column>
													<h:outputText value="#{detalleS22.marcoPresupuestario}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												
												<p:column>
													<h:outputText value="#{detalleS22.transferenciaAcumulada}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												<p:column>
													<span class="textoAjustado textoPequenio">#{detalleS22.porcentajeTransferencia}</span>
												</p:column>
												<p:column>
													<h:outputText value="#{detalleS22.conveniosRecibidos}" styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												<p:column>
													<span class="textoAjustado textoPequenio">#{detalleS22.porcentajeConveniosRecibidos}</span>
												</p:column>
												<c:forEach items="#{detalleS22.remesas}" var="remesa">
													<c:forEach items="#{remesa.dias}" var="dia">
															<p:column>
																<c:if test="#{dia.bloqueado}">
																	<h:outputText value="#{dia.monto}" styleClass="textoAjustado textoPequenio">
																		<f:convertNumber  maxFractionDigits="0"/>
																	</h:outputText> 
																</c:if>
																<c:if test="#{not dia.bloqueado}">
																	<p:inputText value="#{dia.monto}" styleClass="divapProcesoOTProgramaInput" onblur="actualizarHidden(#{rowIndexS22},#{dia.dia},#{remesa.idMes},this.id,22);">
																					<f:convertNumber  maxFractionDigits="0"/>
																	</p:inputText> 
																</c:if>
															</p:column>
													</c:forEach>
												</c:forEach>
												<p:column>
													<h:outputText value="#{detalleS22.diferencia}" styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												<p:column>
													<span class="textoAjustado textoPequenio">#{detalleS22.porcentajeDiferencia}</span>
												</p:column>
												<p:column>
													<p:selectBooleanCheckbox rendered="#{not detalleS22.aprobado}" value="#{detalleS22.aprobado}">
										            	<p:ajax update=":form:tabViewConsolidado:resumenProgramas:tablaResultadosS22" listener="#{procesoOTRevisarConsolidacionController.actualizarS22(rowIndexS22, detalleS22.establecimiento.codigoEstablecimiento)}"/>
										        	</p:selectBooleanCheckbox>
													<h:graphicImage rendered="#{detalleS22.aprobado}" value="resources/minsal/images/check-green.png" styleClass="divapIcons" />	
												</p:column>
											</p:dataTable>
										</p:tab>
									</c:if>
									<c:if test="#{procesoOTRevisarConsolidacionController.subtitulo29}">
										<p:tab title="Subtítulo 29">
											<p:dataTable resizableColumns="true" value="#{procesoOTRevisarConsolidacionController.resultadoServicioSub29}" liveResize="true" var="detalleS29"
												rows="10" paginator="false" paginatorPosition="bottom" emptyMessage="No se encontro información." 
												styleClass="dataTable" id="tablaResultadosS29" rowIndexVar="rowIndexS29">
												<p:columnGroup type="header">
													<p:row>
														<p:column rowspan="3" headerText="Establecimiento" />
														<p:column rowspan="3" headerText="Marco Presupuestario"/>
														<p:column colspan="2" rowspan="2" headerText="Remesa Acumulada a la Fecha"/>
														<p:column colspan="2" rowspan="2" headerText="Convenios Recibidos"/>
														<c:forEach items="#{procesoOTRevisarConsolidacionController.remesasPrograma}" var="remesa">
															<p:column rowspan="1" colspan="#{remesa.cantDias}" headerText="#{remesa.mes}"/>
														</c:forEach>
														<p:column colspan="2" rowspan="2" headerText="Marco - Remesa Acumulada"/>
														<p:column rowspan="3" headerText="Revisado"/>
													</p:row>
													<p:row>
														<c:forEach items="#{procesoOTRevisarConsolidacionController.remesasPrograma}" var="remesa">
															<p:column rowspan="1" colspan="#{remesa.cantDias}" headerText="Días de Remesa"/>
														</c:forEach>
														
													</p:row>
													<p:row>
														<p:column headerText="Monto" />
														<p:column headerText="%" />
														<p:column headerText="Monto" />
														<p:column headerText="%" />
														<c:forEach items="#{procesoOTRevisarConsolidacionController.remesasPrograma}" var="remesa">
															<c:forEach items="#{remesa.dias}" var="dia">
																<p:column headerText="#{dia.dia}"/>
															</c:forEach>
														</c:forEach>
														<p:column headerText="Monto" />
														<p:column headerText="%" />
													</p:row>
												</p:columnGroup>
												<p:column>
													<span class="textoAjustado textoPequenio">#{detalleS29.establecimiento.nombre}</span>
												</p:column>
												<p:column>
													<h:outputText value="#{detalleS29.marcoPresupuestario}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												
												<p:column>
													<h:outputText value="#{detalleS29.transferenciaAcumulada}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												<p:column>
													<span class="textoAjustado textoPequenio">#{detalleS29.porcentajeTransferencia}</span>
												</p:column>
												<p:column>
													<h:outputText value="#{detalleS29.conveniosRecibidos}" styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												<p:column>
													<span class="textoAjustado textoPequenio">#{detalleS29.porcentajeConveniosRecibidos}</span>
												</p:column>
												<c:forEach items="#{detalleS29.remesas}" var="remesa">
													<c:forEach items="#{remesa.dias}" var="dia">
															<p:column>
																<c:if test="#{dia.bloqueado}">
																	<h:outputText value="#{dia.monto}" styleClass="textoAjustado textoPequenio">
																		<f:convertNumber  maxFractionDigits="0"/>
																	</h:outputText> 
																</c:if>
																<c:if test="#{not dia.bloqueado}">
																	<p:inputText value="#{dia.monto}" styleClass="divapProcesoOTProgramaInput" onblur="actualizarHidden(#{rowIndexS29},#{dia.dia},#{remesa.idMes},this.id,29);">
																					<f:convertNumber  maxFractionDigits="0"/>
																	</p:inputText> 
																</c:if>
															</p:column>
													</c:forEach>
												</c:forEach>
												<p:column>
													<h:outputText value="#{detalleS29.diferencia}" styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												<p:column>
													<span class="textoAjustado textoPequenio">#{detalleS29.porcentajeDiferencia}</span>
												</p:column>
												<p:column>
													<p:selectBooleanCheckbox rendered="#{not detalleS29.aprobado}" value="#{detalleS29.aprobado}">
										            	<p:ajax update=":form:tabViewConsolidado:resumenProgramas:tablaResultadosS29" listener="#{procesoOTRevisarConsolidacionController.actualizarS29(rowIndexS29, detalleS29.establecimiento.codigoEstablecimiento)}"/>
										        	</p:selectBooleanCheckbox>
													<h:graphicImage rendered="#{detalleS29.aprobado}" value="resources/minsal/images/check-green.png" styleClass="divapIcons" />	
												</p:column>
											</p:dataTable>
										</p:tab>
									</c:if>
									<c:if test="#{procesoOTRevisarConsolidacionController.subtitulo24}">
										<p:tab title="Subtítulo 24">
											<p:dataTable resizableColumns="true" value="#{procesoOTRevisarConsolidacionController.resultadoMunicipal}" liveResize="true" var="detalleS24"
												rows="10" paginator="false" paginatorPosition="bottom" emptyMessage="No se encontro información." 
												styleClass="dataTable" id="tablaResultadosS24" rowIndexVar="rowIndexS24">
												<p:columnGroup type="header">
													<p:row>
														<p:column rowspan="3" headerText="Comuna" />
														<p:column rowspan="3" headerText="Marco Presupuestario"/>
														<p:column colspan="2" rowspan="2" headerText="Transferencia Acumulada a la Fecha"/>
														<p:column colspan="2" rowspan="2" headerText="Convenios Recibidos"/>
														<c:forEach items="#{procesoOTRevisarConsolidacionController.remesasPrograma}" var="remesa">
															<p:column rowspan="1" colspan="#{remesa.cantDias}" headerText="#{remesa.mes}"/>
														</c:forEach>
														<p:column colspan="2" rowspan="2" headerText="Marco - Remesa Acumulada"/>
														<p:column rowspan="3" headerText="Revisado"/>
													</p:row>
													<p:row>
														<c:forEach items="#{procesoOTRevisarConsolidacionController.remesasPrograma}" var="remesa">
															<p:column rowspan="1" colspan="#{remesa.cantDias}" headerText="Días de Remesa"/>
														</c:forEach>
														
													</p:row>
													<p:row>
														<p:column headerText="Monto" />
														<p:column headerText="%" />
														<p:column headerText="Monto" />
														<p:column headerText="%" />
														<c:forEach items="#{procesoOTRevisarConsolidacionController.remesasPrograma}" var="remesa">
															<c:forEach items="#{remesa.dias}" var="dia">
																<p:column headerText="#{dia.dia}"/>
															</c:forEach>
														</c:forEach>
														<p:column headerText="Monto" />
														<p:column headerText="%" />
													</p:row>
												</p:columnGroup>
												<p:column>
													<span class="textoAjustado textoPequenio">#{detalleS24.comuna.nombre}</span>
												</p:column>
												<p:column>
													<h:outputText value="#{detalleS24.marcoPresupuestario}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												
												<p:column>
													<h:outputText value="#{detalleS24.transferenciaAcumulada}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												<p:column>
													<h:outputText value="#{detalleS24.porcentajeTransferencia}"  styleClass="textoAjustado textoPequenio">
													</h:outputText>
												</p:column>
												<p:column>
													<h:outputText value="#{detalleS24.conveniosRecibidos}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												<p:column>
													<h:outputText value="#{detalleS24.porcentajeConveniosRecibidos}"  styleClass="textoAjustado textoPequenio">
													</h:outputText>
												</p:column>
												<c:forEach items="#{detalleS24.remesas}" var="remesa">
													<c:forEach items="#{remesa.dias}" var="dia">
															<p:column>
																<c:if test="#{dia.bloqueado}">
																	<h:outputText value="#{dia.monto}" styleClass="textoAjustado textoPequenio">
																		<f:convertNumber  maxFractionDigits="0"/>
																	</h:outputText> 
																</c:if>
																<c:if test="#{not dia.bloqueado}">
																	<p:inputText value="#{dia.monto}" styleClass="divapProcesoOTProgramaInput" onblur="actualizarHidden(#{rowIndexS24},#{dia.dia},#{remesa.idMes},this.id, 24);">
																					<f:convertNumber  maxFractionDigits="0"/>
																	</p:inputText> 
																</c:if>
															</p:column>
													</c:forEach>
												</c:forEach>
												<p:column>
													<h:outputText value="#{detalleS24.diferencia}"  styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												<p:column>
													<h:outputText value="#{detalleS24.porcentajeDiferencia}"  styleClass="textoAjustado textoPequenio">
													</h:outputText>
												</p:column>
												<p:column>
													<p:selectBooleanCheckbox rendered="#{not detalleS24.aprobado}" value="#{detalleS24.aprobado}">
										            	<p:ajax update=":form:tabViewConsolidado:resumenProgramas:tablaResultadosS24" listener="#{procesoOTRevisarConsolidacionController.actualizarS24(rowIndexS29, detalleS24.comuna.idComuna)}"/>
										        	</p:selectBooleanCheckbox>
													<h:graphicImage rendered="#{detalleS24.aprobado}" value="resources/minsal/images/check-green.png" styleClass="divapIcons" />	
												</p:column>
											</p:dataTable>
										</p:tab>
									</c:if>
									<c:if test="#{procesoOTRevisarConsolidacionController.percapita}">
										<p:tab title="Per Capita">
											<p:dataTable resizableColumns="true" value="#{procesoOTRevisarConsolidacionController.resultadoPercapita}" liveResize="true" var="detallePercapita"
												rows="10" paginator="false" paginatorPosition="bottom" emptyMessage="No se encontro información." 
												styleClass="dataTable" id="tablaResultadosPercapita" rowIndexVar="rowIndexPerCapita">
												<p:columnGroup type="header">
													<p:row>
														<p:column rowspan="3" headerText="Comuna" />
														<p:column rowspan="3" headerText="Clasificación" />
														<p:column rowspan="3" headerText="Marco Presupuestario ($)"/>
														<p:column colspan="2" rowspan="2" headerText="Remesa Acumulada a la Fecha"/>
														<c:forEach items="#{procesoOTRevisarConsolidacionController.remesasPerCapita}" var="remesa">
															<p:column rowspan="1" colspan="#{remesa.cantDias}" headerText="#{remesa.mes}"/>
														</c:forEach>
														<p:column colspan="2" rowspan="2" headerText="Marco - Remesa Acumulada"/>
														<p:column rowspan="3" headerText="Revisado"/>
													</p:row>
													<p:row>
														<c:forEach items="#{procesoOTRevisarConsolidacionController.remesasPerCapita}" var="remesa">
															<p:column rowspan="1" colspan="#{remesa.cantDias}" headerText="Días de Remesa"/>
														</c:forEach>
														
													</p:row>
													<p:row>
														<p:column headerText="Monto ($)" />
														<p:column headerText="%" />
														<c:forEach items="#{procesoOTRevisarConsolidacionController.remesasPerCapita}" var="remesa">
															<c:forEach items="#{remesa.dias}" var="dia">
																<p:column headerText="#{dia.dia}"/>
															</c:forEach>
														</c:forEach>
														<p:column headerText="Monto ($)" />
														<p:column headerText="%" />
													</p:row>
												</p:columnGroup>
													<p:column>
													<span class="textoAjustado textoPequenio">#{detallePercapita.comuna}</span>
												</p:column>
												<p:column>
													<span class="textoAjustado textoPequenio">#{detallePercapita.tipoComuna}</span>
												</p:column>
												<p:column>
													<h:outputText styleClass="textoAjustado textoPequenio" value="#{detallePercapita.marcoPresupuestario}">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												
												<p:column>
													<h:outputText styleClass="textoAjustado textoPequenio" value="#{detallePercapita.transferenciaAcumulada}">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												<p:column>
													<span class="textoAjustado textoPequenio">#{detallePercapita.porcentajeTransferenciaAcumulada}</span>
												</p:column>
												<c:forEach items="#{detallePercapita.remesas}" var="remesa">
													<c:forEach items="#{remesa.dias}" var="dia">
															<p:column>
																<c:if test="#{dia.bloqueado}">
																	<h:outputText value="#{dia.monto}" styleClass="textoAjustado textoPequenio">
																		<f:convertNumber  maxFractionDigits="0"/>
																	</h:outputText> 
																</c:if>
																<c:if test="#{not dia.bloqueado}">
																	<h:inputText value="#{dia.monto}" styleClass="divapProcesoOTInput">
																		<f:convertNumber  maxFractionDigits="0"/>
																	</h:inputText> 
																</c:if>
															</p:column>
													</c:forEach>
												</c:forEach>
												<p:column>
													<h:outputText styleClass="textoAjustado textoPequenio" value="#{detallePercapita.diferencia}">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
												<p:column>
													<span class="textoAjustado textoPequenio">#{detallePercapita.porcentajeDiferencia}</span>
												</p:column>
												<p:column>
													<p:selectBooleanCheckbox rendered="#{not detallePercapita.aprobado}" value="#{detallePercapita.aprobado}">
										            	<p:ajax update=":form:tabViewConsolidado:resumenProgramas:tablaResultadosPercapita" listener="#{procesoOTRevisarConsolidacionController.actualizarPerCapita(rowIndexPerCapita, detallePercapita.idComuna)}"/>
										        	</p:selectBooleanCheckbox>
													<h:graphicImage rendered="#{detallePercapita.aprobado}" value="resources/minsal/images/check-green.png" styleClass="divapIcons" />	
												</p:column>
											</p:dataTable>
										</p:tab>
									</c:if>
									
								</p:tabView>
							</p:tab>
							<p:tab id="tab23" title="Resumen Totales">
										<h:outputText value="Programa: " styleClass="inputLabel" />
									<p:selectOneMenu id="programasResumen"  value="#{procesoOTRevisarConsolidacionController.programaSeleccionadoResumen}">
										<f:selectItem itemLabel="Seleccione" itemValue="" />  
										<f:selectItems value="#{procesoOTRevisarConsolidacionController.listaProgramasResumen}" itemLabel="#{programa.nombre}" var="programa" itemValue="#{programa.idProgramaAno}"/>
									</p:selectOneMenu>
								<br />
								<p:commandButton value="Buscar" id="buscarListadoResumen" styleClass="x-btn-text" icon="ui-icon-search" actionListener="#{procesoOTRevisarConsolidacionController.buscarResumenPrograma}" update=":form:tabViewConsolidado:tablaResultadosResumen" oncomplete="actualizarTabla();"/>
								
								<p:dataTable resizableColumns="true" value="#{procesoOTRevisarConsolidacionController.resumenPrograma}" liveResize="true"
									var="servicio" rows="40" paginator="true" paginatorPosition="bottom" emptyMessage="No se encontro información."
									styleClass="dataTable" id="tablaResultadosResumen" rowIndexVar="rowIndex">
									<p:columnGroup type="header">
										<p:row>
											<p:column headerText="Servicio" width="350px;"/>
											<c:if test="#{procesoOTRevisarConsolidacionController.subtitulo24Resumen}">
												<p:column headerText="Subtítulo 24" />
											</c:if>
											<c:if test="#{procesoOTRevisarConsolidacionController.subtitulo21Resumen}">
												<p:column headerText="Subtítulo 21" />
											</c:if>
											<c:if test="#{procesoOTRevisarConsolidacionController.subtitulo22Resumen}">
												<p:column headerText="Subtítulo 22" />
											</c:if>
											<c:if test="#{procesoOTRevisarConsolidacionController.subtitulo29Resumen}">
												<p:column headerText="Subtítulo 29" />
											</c:if>
											<p:column headerText="Total ($)" />
										</p:row>
									</p:columnGroup>
											<p:column>#{servicio.nombreServicio}</p:column>
											<c:if test="#{procesoOTRevisarConsolidacionController.subtitulo24Resumen}">
												<p:column>
													<h:outputText value="#{servicio.totalS24}" styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
											</c:if>
											<c:if test="#{procesoOTRevisarConsolidacionController.subtitulo21Resumen}">
												<p:column>
													<h:outputText value="#{servicio.totalS21}" styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
											</c:if>
											<c:if test="#{procesoOTRevisarConsolidacionController.subtitulo22Resumen}">
												<p:column>
													<h:outputText value="#{servicio.totalS22}" styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
											</c:if>
											<c:if test="#{procesoOTRevisarConsolidacionController.subtitulo29Resumen}">
												<p:column>
													<h:outputText value="#{servicio.totalS29}" styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</p:column>
											</c:if>
											<p:column>
												<h:outputText value="#{servicio.totalServicio}" styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
											</p:column>
									<p:columnGroup type="footer">
									<p:row>
										<p:column/>
										<c:if test="#{procesoOTRevisarConsolidacionController.subtitulo24Resumen}">
											<p:column>
												<f:facet name="footer">
													<h:outputText value="#{procesoOTRevisarConsolidacionController.totalSub24Resumen}" styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</f:facet>
											</p:column>
										</c:if>
										<c:if test="#{procesoOTRevisarConsolidacionController.subtitulo21Resumen}">
											<p:column>
												<f:facet name="footer">
													<h:outputText value="#{procesoOTRevisarConsolidacionController.totalSub21Resumen}" styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</f:facet>
											</p:column>
										</c:if>
										<c:if test="#{procesoOTRevisarConsolidacionController.subtitulo22Resumen}">
											<p:column>
												<f:facet name="footer">
													<h:outputText value="#{procesoOTRevisarConsolidacionController.totalSub22Resumen}" styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</f:facet>
											</p:column>
										</c:if>
										<c:if test="#{procesoOTRevisarConsolidacionController.subtitulo29Resumen}">
											<p:column>
												<f:facet name="footer">
													<h:outputText value="#{procesoOTRevisarConsolidacionController.totalSub29Resumen}" styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</f:facet>
											</p:column>
										</c:if>
										<p:column>
												<f:facet name="footer">
													<h:outputText value="#{procesoOTRevisarConsolidacionController.totalResumen}" styleClass="textoAjustado textoPequenio">
														<f:convertNumber  maxFractionDigits="0"/>
													</h:outputText>
												</f:facet>
											</p:column>
										</p:row>
									</p:columnGroup>
									
									</p:dataTable>
							</p:tab>
						</p:tabView>

							<p:commandButton value="Ordenes de Transferencia Correctas | Finalizar Revisión Consolidada" styleClass="x-btn-text"
								action="#{procesoOTRevisarConsolidacionController.iniciarProceso}" ajax="false" icon="ui-icon-seek-first" disabled="#{procesoOTRevisarConsolidacionController.botonBloqueado}">
								<f:setPropertyActionListener target="#{procesoOTRevisarConsolidacionController.target}" value="bandejaTareas.jsf" />
							</p:commandButton>
					</div>

			</p:panel>
		</h:form>
		<h:form id="form2">
			<h:inputHidden value="#{procesoOTRevisarConsolidacionController.filaHidden}" id="fila"/>
			<h:inputHidden value="#{procesoOTRevisarConsolidacionController.diaHidden}" id="dia"/>
			<h:inputHidden value="#{procesoOTRevisarConsolidacionController.mesHidden}" id="mes"/>
			<h:inputHidden value="#{procesoOTRevisarConsolidacionController.montoHidden}" id="monto"/>
			<h:inputHidden value="#{procesoOTRevisarConsolidacionController.subtituloHidden}" id="subtitulo"/>
			<p:commandButton id="botonActualizar" value="actualiza" style="display: none" action="#{procesoOTRevisarConsolidacionController.actualizarCamposHidden}"/>
		</h:form>
		</ui:define>
</ui:composition>